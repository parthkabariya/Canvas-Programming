<html>
<head>
	<title>Goku</title>
	<style type="text/css">
		#canvas{
			background-color: black;
		}
	</style>

	<script type="application/javascript">

		function gokuAttack(c,w,h,ImageWidth,turn,hCenter,radius,posX){
			var attacks={};
		    var attackIndex=0; 
		    var attackNum= 100,
		    	count1 = 0,
		    	attackTimeOut=0;

				function attack(){
					if(turn == 0){
				        this.x= posX;
				        this.y= h/2-(hCenter);
				    }
				    else{
				    	this.x= ImageWidth + 05;
				        this.y= h/2-(hCenter);
				    }
			        this.vxAttack=Math.random()* 10-5;
			        this.vyAttack=Math.random()* 10-5;
			 
			        attackIndex++;
			        attacks[attackIndex]=this;
			        this.id=attackIndex;
			    }

            var grativeOfX = 0;
            var boolean1 = false;
            if(turn == 1)
          		 grativeOfX = 0.8;
          
		        while(!boolean1){
		          	this.r = Math.random()*6;
			        if(this.r >= 3 && this.r <=5 ){
			        		var radiusOfA = this.r;
			           		boolean1 = true;
			       	}	
		   		}

	        this.alpha = Math.random()*.5+.5;
		    var color;   
		    if(turn == 1)
		        	color = "#f0f0f0";
		    else
		        	color = "rgba(251,136,66,0.2)";


    			attack.prototype.draw = function(){
			        this.x += this.vxAttack;
			        this.y += this.vyAttack;
			        this.vxAttack += grativeOfX;
			        this.alpha += 1000;

			        c.save();
					c.fillStyle= color;
					c.globalAlpha = this.alpha;
					c.beginPath();
					c.arc(posX,h/2-(hCenter),radius,0,Math.PI*2);
					c.arc(this.x,this.y,radiusOfA,0,Math.PI*2);
					c.fill();
					c.closePath();
					c.restore();
		    	}

	            var attack1out = setInterval(function(){
		          	if(turn == 0){
		          		c.globalCompositeOperation = 'source-over';
			            c.fillStyle = "rgba(0,0,0,0.2)";
			            c.fillRect(this.x, 0, w, h);
			            c.globalCompositeOperation = 'lighter';
		          	}

	            	count1++;

		            for (var i=0; i<attackNum; i++){
		             new attack();
		            }

		            if(turn == 0)
		            	attackTimeOut = Math.floor((100/1366)*w)/2+10;
		            else if(turn == 1)
		            	attackTimeOut = Math.floor((100/1366)*w)/2+45;
	            
	            	for (var i in attacks){attacks[i].draw();}
	            		if(count1 == attackTimeOut){
	            			window.clearTimeout(attack1out);
	            			location.reload(true);
	            		}
	            },30);
		};

		function gokuAttack2(c,w,h,ImageWidth,radius,hCenter,turn){
			var posX = ImageWidth +20,
				count2 = 0;

			function upperBlock(){
					c.globalCompositeOperation = 'source-over';
			        c.fillStyle= "rgba(0,0,0,0.2)";
			        c.fillRect(ImageWidth,0,w-ImageWidth*2,h/2-(hCenter)-10);
			        c.globalCompositeOperation = 'lighter';
			}

			function lowerBlock(){
					c.globalCompositeOperation = 'source-over';
					c.fillStyle= "rgba(0,0,0,0.2)";
					c.fillRect(ImageWidth,h/2-(hCenter)+10,w-ImageWidth*2,h);
					c.globalCompositeOperation = 'lighter';
			}

			var attack2out = setInterval(function(){
					count2++;
					upperBlock();
					lowerBlock();
					posX += 5;
					c.save();
			        c.fillStyle= "#f0f0f0";
			        c.globalAlpha = this.alpha;
			        c.beginPath();
			        c.arc(posX,h/2-(hCenter),radius,0,Math.PI*2);
			        c.arc(ImageWidth +20,h/2-(hCenter),radius,0,Math.PI*2);
			        c.fill();
			        c.closePath();
			        c.restore();
			        if(posX >= (w-ImageWidth)){
			        	window.clearTimeout(attack2out);
			        	gokuAttack(c,w,h,ImageWidth,turn,hCenter,radius,posX);
			        }
			},30);
		};

		window.onload = function(){
				var canvas = document.getElementById('canvas');
				var c = canvas.getContext('2d');
				var w = canvas.width = window.innerWidth;
				var h = canvas.height = window.innerHeight;
				var radius = 2;
				var ImageHeight = h*0.5,
					ImageWidth = w*0.2,
				 	count = 0,
				 	countlimit,
				 	hCenter = h*0.045,
				 	turn = ~~(Math.random()*2),
				 	kameLimit = 20,
				 	hameLimit = 47;	

				var goku_img = new Image();
				  	goku_img.src = 'goku.jpg';
				  	//img.crossOrigin = "Anonymous";
				goku_img.onload = function(){
					var imageYlocation = h/2-((h*0.5)/2); 
				    c.drawImage(goku_img,0,imageYlocation,ImageWidth,ImageHeight);
				}

				var frieza_img = new Image();
					frieza_img.src = 'Frieza.jpg';
				frieza_img.onload = function(){
				var imageYlocation = h/2-((h*0.5)/2); 
				    c.drawImage(frieza_img,w-ImageWidth,imageYlocation,ImageWidth,ImageHeight);
				}

					countlimit = 0.035;
				if(w <= 400)
				  	countlimit = 0.090;

				timeOutId = setInterval(function(){
					 	c.fillStyle = "black";
						c.fillRect(0,0,1000,200);

					 	c.save();
				        c.fillStyle= "#f0f0f0";
				        c.globalAlpha = this.alpha;
				        c.beginPath();
				        c.arc(ImageWidth + 20,h/2-(hCenter),radius++,0,Math.PI*2);
				        c.fill();
				        c.closePath();
				        c.restore();
				        count++;

				        c.fillStyle = "red";
				        c.font = "100px forte";
				    if(count <= kameLimit)
				        c.fillText("kamey......", 10, 60);
				    	
				    else if(count <= hameLimit && count>=kameLimit){		    
				    	c.fillText("hamey......", 10, 60);
			    	}
			        
					
			        if(count >= Math.floor(w*countlimit)){
						window.clearTimeout(timeOutId);
							switch(turn){
								case 1:
										c.fillStyle = "black";
										c.fillRect(0,0,1000,200);
										c.fillStyle = "red";
										c.font = "50px forte";
										c.fillText("ha..", 10, 60);
										gokuAttack(c,w,h,ImageWidth,turn,hCenter,radius);
												break;
								case 0:
										c.fillStyle = "black";
										c.fillRect(0,0,1000,200);
										c.fillStyle = "red";
										c.font = "50px forte";
										c.fillText("ha..", 10, 60);
										gokuAttack2(c,w,h,ImageWidth,radius,hCenter,turn);
												break;
							}
					}

				},100);
		};			
	
	</script>
</head>
<body>
	<canvas id="canvas"></canvas>
</body>
</html>
